# DB migration guideline

1. 每个版本都有自己对应的数据库脚本升级目录，但数据库升级脚本的根目录为当前目录

2. 如果当前为v1.0则当前数据库脚本的升级目录为v1.0，如果为v2.0，则当前数据库脚本的升级目录为v2.0，如果不存在则手动创建

3. 升级文件必须为SQL文件

4. 文件名的标准为：Vx.y.z__yyyyMMddhhMMss_author_description.sql，其中x.y.z表示版本号，yyyyMMddhhMMss为时间戳，author为作者名，description为简单描述，所有可变参数中不能出现中文和空格，如果需要连接符则使用下划线，文件名必须使用大写字母V开头

5. 升级脚本的版本号不能重复

6. 如果某个版本升级失败，需要手动回滚（免费版不支持自动回滚），方法为：先删除数据库中flyway_schema_version表中升级失败版本的数据，然后重新启动应用即可（注意某些情况下需要手动删除部分执行成功的修改）

7. 数据库结构变化的升级不能与数据升级放在同一个升级文件中

8. 不要删除数据库任何字段，升级只做字段增加，不减少任何历史遗留字段
